<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
	<link rel="icon" href="http://qiniu.gaowenju.com/favicon.ico">
	<title>寻宝 | 坑人的小书童</title>
	<meta name="generator" content="VuePress 1.5.2">
	
	<meta name="description" content="每天一道leetcode，从零开始学习算法 一天一大leet 小书童 坑人的小书童">
	<link rel="preload" href="/oneday_oneleetcode/assets/css/0.styles.696b879c.css" as="style"><link rel="preload" href="/oneday_oneleetcode/assets/js/app.a6cb5e08.js" as="script"><link rel="preload" href="/oneday_oneleetcode/assets/js/2.f1097bd3.js" as="script"><link rel="preload" href="/oneday_oneleetcode/assets/js/68.0f7fc874.js" as="script"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/10.729d422e.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/100.7574bfef.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/101.c94c02d8.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/102.1f6f9c8c.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/103.082a0e22.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/104.5c88f0bd.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/105.9a9a1717.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/106.5f374b6f.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/107.89c184a2.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/108.8d0645de.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/11.301d9995.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/12.402732c8.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/13.cb8d2b9a.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/14.74fa90f1.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/15.b37db184.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/16.7f3557a3.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/17.7632193f.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/18.9daff543.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/19.b7148f75.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/20.0d6baf55.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/21.80cb68b5.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/22.5b0e72ba.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/23.69d709ee.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/24.e7b25779.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/25.a1867d2c.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/26.393a7544.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/27.fb233edc.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/28.c9c47775.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/29.c965a8c4.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/3.56b12585.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/30.d57e742d.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/31.48e401dd.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/32.fd943e94.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/33.ca7f36c2.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/34.82cd751c.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/35.76d47002.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/36.c343df3b.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/37.20e41c06.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/38.8ccdb693.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/39.b47daaef.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/4.fc8f5016.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/40.9d3f5897.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/41.fabddd38.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/42.ced1aa4c.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/43.77134ea3.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/44.a4141563.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/45.70f55427.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/46.0caa9e95.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/47.7545c5e9.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/48.6b25df84.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/49.89db0212.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/5.a4ab27b0.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/50.50914bae.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/51.69cf2328.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/52.beb5e4e4.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/53.d4b142b9.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/54.e715ce4b.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/55.d55db00b.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/56.e5f0246c.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/57.fd044775.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/58.1d2836b6.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/59.c899c4c3.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/6.82615a75.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/60.a25f6523.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/61.eb020a2e.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/62.d78e6e89.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/63.3805b37c.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/64.e69f6011.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/65.f3967a68.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/66.8237798d.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/67.d98a762e.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/69.aebd19de.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/7.a3c0f1ef.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/70.ec715a24.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/71.b1d2764e.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/72.a0de8ec4.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/73.1ab8fbf6.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/74.8488719e.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/75.6505cad9.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/76.af65e288.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/77.fb5e3ff3.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/78.0f7c34ae.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/79.175884dc.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/8.4c840cb7.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/80.3b471266.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/81.9ca8389c.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/82.d416fac0.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/83.8c3180b9.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/84.0e63fedd.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/85.7ea0dad5.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/86.84be0ae5.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/87.a4285f4b.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/88.f8782f80.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/89.365eaa94.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/9.27eb3691.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/90.00ea1e2f.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/91.a294cc6d.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/92.d8c3cf71.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/93.076bde18.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/94.9296e0c3.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/95.f4bdcd2b.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/96.e6e09a0b.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/97.8d3d3850.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/98.761e88d7.js"><link rel="prefetch" href="/oneday_oneleetcode/assets/js/99.05e8d2da.js">
	<link rel="stylesheet" href="/oneday_oneleetcode/assets/css/0.styles.696b879c.css">
</head>

<body>
	<!-- 构建时基于 Vue SSR 的 HTML 模板文件。 -->
	<div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/oneday_oneleetcode/" class="home-link router-link-active"><img src="http://qiniu.gaowenju.com/bookc.png" alt="坑人的小书童" class="logo"> <span class="site-name can-hide">坑人的小书童</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/oneday_oneleetcode/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="leetcode" class="dropdown-title"><span class="title">leetcode</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/oneday_oneleetcode/leetcode/202006/" class="nav-link">
  202006
</a></li><li class="dropdown-item"><!----> <a href="/oneday_oneleetcode/leetcode/202007/" class="nav-link router-link-active">
  202007
</a></li><li class="dropdown-item"><!----> <a href="/oneday_oneleetcode/leetcode/202008/" class="nav-link">
  202008
</a></li><li class="dropdown-item"><!----> <a href="/oneday_oneleetcode/leetcode/more/" class="nav-link">
  more
</a></li></ul></div></div><div class="nav-item"><a href="/oneday_oneleetcode/blog/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="http://gaowenju.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/oneday_oneleetcode/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="leetcode" class="dropdown-title"><span class="title">leetcode</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/oneday_oneleetcode/leetcode/202006/" class="nav-link">
  202006
</a></li><li class="dropdown-item"><!----> <a href="/oneday_oneleetcode/leetcode/202007/" class="nav-link router-link-active">
  202007
</a></li><li class="dropdown-item"><!----> <a href="/oneday_oneleetcode/leetcode/202008/" class="nav-link">
  202008
</a></li><li class="dropdown-item"><!----> <a href="/oneday_oneleetcode/leetcode/more/" class="nav-link">
  more
</a></li></ul></div></div><div class="nav-item"><a href="/oneday_oneleetcode/blog/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="http://gaowenju.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>寻宝</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/oneday_oneleetcode/leetcode/202007/20200729.html#题目" class="sidebar-link">题目:</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/oneday_oneleetcode/leetcode/202007/20200729.html#示例" class="sidebar-link">示例:</a></li><li class="sidebar-sub-header"><a href="/oneday_oneleetcode/leetcode/202007/20200729.html#限制：" class="sidebar-link">限制：</a></li></ul></li><li><a href="/oneday_oneleetcode/leetcode/202007/20200729.html#抛砖引玉" class="sidebar-link">抛砖引玉</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="寻宝"><a href="#寻宝" class="header-anchor">#</a> 寻宝</h3> <div class="custom-block tip"><p class="custom-block-title">难度</p> <p>困难</p></div> <p><img src="http://qiniu.gaowenju.com/leecode/banner/20200729.jpg" alt="img"></p> <h2 id="题目"><a href="#题目" class="header-anchor">#</a> <a href="https://leetcode-cn.com/problems/xun-bao/" target="_blank" rel="noopener noreferrer">题目:<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <p>我们得到了一副藏宝图，藏宝图显示，在一个迷宫中存在着未被世人发现的宝藏。</p> <p>迷宫是一个二维矩阵，用一个字符串数组表示。它标识了唯一的入口（用 'S' 表示），和唯一的宝藏地点（用 'T' 表示）。
但是，宝藏被一些隐蔽的机关保护了起来。在地图上有若干个机关点（用 'M' 表示），只有所有机关均被触发，才可以拿到宝藏。</p> <p>要保持机关的触发，需要把一个重石放在上面。迷宫中有若干个石堆（用 'O' 表示），每个石堆都有无限个足够触发机关的重石。
但是由于石头太重，我们一次只能搬一个石头到指定地点。</p> <p>迷宫中同样有一些墙壁（用 '#' 表示），我们不能走入墙壁。剩余的都是可随意通行的点（用 '.' 表示）。
石堆、机关、起点和终点（无论是否能拿到宝藏）也是可以通行的。</p> <p>我们每步可以选择向上/向下/向左/向右移动一格，并且不能移出迷宫。搬起石头和放下石头不算步数。
那么，从起点开始，我们最少需要多少步才能最后拿到宝藏呢？如果无法拿到宝藏，返回 -1 。</p> <h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例:</h3> <ul><li>示例 1:</li></ul> <p>输入： [&quot;S#O&quot;, &quot;M..&quot;, &quot;M.T&quot;]</p> <p>输出：16</p> <p>解释：
最优路线为： S-&gt;O, cost = 4, 去搬石头 O-&gt;第二行的 M, cost = 3, M 机关触发 第二行的 M-&gt;O, cost = 3, 我们需要继续回去 O 搬石头。
O-&gt;第三行的 M, cost = 4, 此时所有机关均触发 第三行的 M-&gt;T, cost = 2，去 T 点拿宝藏。 总步数为 16。</p> <p><img src="http://qiniu.gaowenju.com/leecode/banner/20200729.gif" alt="img"></p> <ul><li>示例 2:</li></ul> <p>输入： [&quot;S#O&quot;, &quot;M.#&quot;, &quot;M.T&quot;]</p> <p>输出：-1</p> <p>解释：我们无法搬到石头触发机关</p> <ul><li>示例 3:</li></ul> <p>输入： [&quot;S#O&quot;, &quot;M.T&quot;, &quot;M..&quot;]</p> <p>输出：17</p> <p>解释：注意终点也是可以通行的。</p> <h3 id="限制："><a href="#限制：" class="header-anchor">#</a> 限制：</h3> <ul><li>1 &lt;= maze.length &lt;= 100</li> <li>1 &lt;= maze[i].length &lt;= 100</li> <li>maze[i].length == maze[j].length</li> <li>S 和 T 有且只有一个</li> <li>0 &lt;= M 的数量 &lt;= 16</li> <li>0 &lt;= O 的数量 &lt;= 40，题目保证当迷宫中存在 M 时，一定存在至少一个 O 。</li></ul> <h2 id="抛砖引玉"><a href="#抛砖引玉" class="header-anchor">#</a> 抛砖引玉</h2> <p><img src="http://qiniu.gaowenju.com/leecode/20200729.png" alt="img"></p> <p><strong>回想下之前做过的题目</strong></p> <ul><li>有障碍的矩阵<a href="/oneday_oneleetcode/leetcode/202007/20200706.html">20200706: 不同路径 II (难度:中等)</a></li> <li>四个方向行进的矩阵<a href="/oneday_oneleetcode/leetcode/202007/20200726.html">20200726: 矩阵中的最长递增路径 (难度:困难)</a></li></ul> <p><strong>思路</strong></p> <p>先理下题目中步数的组成：</p> <ul><li>有障碍(墙#)的起点到终点</li> <li>未知起点，终点</li> <li>路径中存在指定点必须经过(机关 M,石块 O)</li></ul> <hr> <ol><li>S-&gt;石块 O-&gt;机关 M</li> <li>机关 $M_i$-&gt;石块 O-&gt;机关 $M_j$</li> <li>机关 M -&gt;T</li></ol> <hr> <p>1,3 路线中的步数，可以分解成已经做过的逻辑：</p> <ul><li>从 S 到 O 有障碍的路径(枚举所有 O)</li> <li>从 O 到 M 有障碍的路径((枚举所有 O 及对应的所有 M)</li> <li>从 M 到 T 有障碍的路径(枚举所有 M)</li></ul> <p>2 中$M_i$及$M_j$为不同点</p> <ul><li>那么不同的 M 点组合就会有不同的结果</li> <li>没有不同组合下的最小路径</li> <li>更加官方思路使用二进制数标识不同的 M 点组合，
<ul><li>1 表示已触发机关包含这个 M 点，</li> <li>0 表示这个 M 点未触发</li></ul></li></ul> <p><strong>实现</strong></p> <ul><li>找出起始点 S 和终点 T，M，O 坐标</li> <li>记录 S 点到其他点的最小步数，无法到达的单元格填充-1 -&gt; startDist[i][j]</li> <li>记录第 i 个 M 点到任意 O 点再到第 j 个 M 点的最小步数，无法到达的单元格填充-1 -&gt; dist[m_i][m_j]
设存在 nb 个 M 点则：
dist[m_i][nb] -&gt; 记录该 M 点到起点最小步数
dist[m_i][nb+1] -&gt; 记录该 M 点到 T 点最小步数</li></ul> <p>dist 二维数组，dist[m_i][m_j]:</p> <ul><li><p>第 i 个 M-&gt;O-&gt;第 j 个 M 的最小的步数 dist[m_i][m_j]</p></li> <li><p>S-&gt;O-&gt;第 i 个 M 最小步数 dist[m_i][nb]</p></li> <li><p>T&lt;-O&lt;-第 i 个 M 最小步数 dist[m_i][nb+1]</p></li> <li><p>声明 dp 表示指定 m 点为第一个触发的 M 点是，起点到 M-O-M 组合最小步数和</p></li> <li><p>M-O-M 组合最小步数和</p></li> <li><p>枚举不同的 M 点组合，使用二进制数标记 M 点位置，则对所有的 M 点上层循环，生产两次 m 点组合
重叠的二进制位取| 或，表示该位的 M 点已触发，</p></li> <li><p>相邻 dp 之间关系：</p> <ul><li>增加一个 M 点,上一个组合的步数最小值+新增 M 点-O-M
dp[next][j] = dp[i][j]+dist[i][j]</li> <li>next ：下一个组合通过增加 连接 M 点即修改二进制数中 1 的位置完成</li></ul></li> <li><p>M-O-M 组合的最小步数及二进制数值只剩一个 0（与 T 连接）时为组合最小步数</p></li></ul> <p>枚举不同组合的最小步数+连接 T 的步数
返回最小的和及需要的结果</p> <hr> <p>无法满足条件的情况：</p> <ul><li>起点无法到达终点</li> <li>存在 M 点无法连接起点或者终点</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
 * @param {string[]} maze
 * @return {number}
 */</span>
<span class="token keyword">var</span> <span class="token function-variable function">minimalSteps</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">maze</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> dirs <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 上方</span>
      <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 下方</span>
      <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 左侧</span>
      <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 右侧</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    n <span class="token operator">=</span> maze<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
    m <span class="token operator">=</span> maze<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">?</span> maze<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    buttons <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 机关-&gt;M 坐标集</span>
    stones <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 石头-&gt;O 坐标集</span>
    start <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    end <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

  <span class="token comment">// 查询起点、终点坐标</span>
  <span class="token comment">// 记录机关、石头坐标</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 机关</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>maze<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'M'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        buttons<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 石头</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>maze<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'O'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        stones<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 开始</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>maze<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'S'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        start <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 结束</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>maze<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'T'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        end <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> nb <span class="token operator">=</span> buttons<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token comment">// 机关数</span>
    ns <span class="token operator">=</span> stones<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token comment">// 石头数</span>
    <span class="token comment">// 记录起点到任一点的步数</span>
    startDist <span class="token operator">=</span> <span class="token function">bfs</span><span class="token punctuation">(</span>start<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> start<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> maze<span class="token punctuation">)</span>

  <span class="token comment">// 边界情况：没有机关直接从起到走到终点及startDist中记录的start坐标到end坐标步数</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nb <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> end_x <span class="token operator">=</span> end<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      end_y <span class="token operator">=</span> end<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> startDist<span class="token punctuation">[</span>end_x<span class="token punctuation">]</span><span class="token punctuation">[</span>end_y<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 记录从每个机关M到终点步数</span>
  <span class="token keyword">let</span> dist <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span>nb<span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> m_i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> m_i <span class="token operator">&lt;</span> nb<span class="token punctuation">;</span> m_i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dist<span class="token punctuation">[</span>m_i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span>nb <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 记录从每个机关M到其他点步数</span>
  <span class="token keyword">let</span> dd <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span>nb<span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nb<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> buttons_x <span class="token operator">=</span> buttons<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      buttons_y <span class="token operator">=</span> buttons<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      end_x <span class="token operator">=</span> end<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      end_y <span class="token operator">=</span> end<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      d <span class="token operator">=</span> <span class="token function">bfs</span><span class="token punctuation">(</span>buttons_x<span class="token punctuation">,</span> buttons_y<span class="token punctuation">,</span> maze<span class="token punctuation">)</span>
    <span class="token comment">// 第i个机关到其他点步数矩阵</span>
    dd<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> d
    <span class="token comment">// 第i个机关到终点的步数-&gt;存放到dist最后一列</span>
    dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>nb <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">[</span>end_x<span class="token punctuation">]</span><span class="token punctuation">[</span>end_y<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 遍历机关M与石头O-计算使用石头触发机关的步数</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nb<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tmp <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>

    <span class="token comment">// 包含起点到石头O部分，即起点为矩阵指定起点</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> ns<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 触发一个M的步数：机关M到石头O的步数+起点到石头O的步数</span>
      <span class="token keyword">let</span> s_x <span class="token operator">=</span> stones<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        s_y <span class="token operator">=</span> stones<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
      <span class="token comment">// 步数为-1则说明此单元格不通</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>dd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>s_x<span class="token punctuation">]</span><span class="token punctuation">[</span>s_y<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> startDist<span class="token punctuation">[</span>s_x<span class="token punctuation">]</span><span class="token punctuation">[</span>s_y<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 第i个M点到达O点，起点到达O点的步数之和的最小值</span>
        <span class="token keyword">let</span> item_num <span class="token operator">=</span> dd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>s_x<span class="token punctuation">]</span><span class="token punctuation">[</span>s_y<span class="token punctuation">]</span> <span class="token operator">+</span> startDist<span class="token punctuation">[</span>s_x<span class="token punctuation">]</span><span class="token punctuation">[</span>s_y<span class="token punctuation">]</span>
        tmp <span class="token operator">=</span> tmp <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> item_num<span class="token punctuation">)</span> <span class="token operator">:</span> item_num
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 从S-&gt;O-&gt;第i个M最小步数，存放到倒数第二列</span>
    dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>nb<span class="token punctuation">]</span> <span class="token operator">=</span> tmp

    <span class="token comment">// 起点为已触发机关M</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> nb<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> tmp <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> ns<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> s_x <span class="token operator">=</span> stones<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          s_y <span class="token operator">=</span> stones<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>s_x<span class="token punctuation">]</span><span class="token punctuation">[</span>s_y<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> dd<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>s_x<span class="token punctuation">]</span><span class="token punctuation">[</span>s_y<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 第i个M-&gt;O-&gt;第j个M</span>
          <span class="token keyword">let</span> item_num <span class="token operator">=</span> dd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>s_x<span class="token punctuation">]</span><span class="token punctuation">[</span>s_y<span class="token punctuation">]</span> <span class="token operator">+</span> dd<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>s_x<span class="token punctuation">]</span><span class="token punctuation">[</span>s_y<span class="token punctuation">]</span>
          tmp <span class="token operator">=</span> tmp <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> item_num<span class="token punctuation">)</span> <span class="token operator">:</span> item_num
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp
      dist<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 有从机关M出发无法到达终点或起点则说明无法 不存在满足题意的路径</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nb<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>nb<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>nb <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 使用二进制为标识M点，组合不同的M-O-M路线求最小值</span>
  <span class="token keyword">let</span> dp <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> nb<span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> nb<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span>nb<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nb<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 第i个机关M作为第一个触发机关的步数</span>
    dp<span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>nb<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 由于更新的状态都比未更新的大，所以直接从小到大遍历即可</span>
  <span class="token comment">// 遍历每个机关点M，查询个M点之间步数最小值</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> mask <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> mask <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> nb<span class="token punctuation">;</span> mask<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nb<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 当前 mask 为标记的M</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mask <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 为指定M点mark  遍历其他M点 查询该点到其他M之间的步数</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> nb<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 当前M点路线组合不包含已在组合中的M点</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mask <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> next <span class="token operator">=</span> mask <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> j<span class="token punctuation">)</span><span class="token punctuation">,</span>
              item_num <span class="token operator">=</span> dp<span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            dp<span class="token punctuation">[</span>next<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>
              dp<span class="token punctuation">[</span>next<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>item_num<span class="token punctuation">,</span> dp<span class="token punctuation">[</span>next<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> item_num
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> _result <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
    finalMask <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> nb<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nb<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 不同的M点在组合中最小的步数+M点到终点的最小步数</span>
    <span class="token keyword">let</span> item_num <span class="token operator">=</span> dp<span class="token punctuation">[</span>finalMask<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>nb <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
    _result <span class="token operator">=</span> _result <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>_result<span class="token punctuation">,</span> item_num<span class="token punctuation">)</span> <span class="token operator">:</span> item_num
  <span class="token punctuation">}</span>

  <span class="token comment">// 参数-&gt; 起点坐标，矩阵</span>
  <span class="token keyword">function</span> <span class="token function">bfs</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> maze</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    result<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> queue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> p <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        curx <span class="token operator">=</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        cury <span class="token operator">=</span> p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> nx <span class="token operator">=</span> curx <span class="token operator">+</span> dirs<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          ny <span class="token operator">=</span> cury <span class="token operator">+</span> dirs<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token comment">// 取出的点可走的路径-&gt;不越界非障碍物#</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>
          <span class="token function">inBound</span><span class="token punctuation">(</span>nx<span class="token punctuation">,</span> ny<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
          maze<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>ny<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">'#'</span> <span class="token operator">&amp;&amp;</span>
          result<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
          result<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span>curx<span class="token punctuation">]</span><span class="token punctuation">[</span>cury<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span>
          queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>nx<span class="token punctuation">,</span> ny<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 返回 n*m的矩阵，填充起点为（x,y）是到达每个单元格的步数</span>
    <span class="token keyword">return</span> result
  <span class="token punctuation">}</span>

  <span class="token comment">// 判断给定坐标是否越界</span>
  <span class="token keyword">function</span> <span class="token function">inBound</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> y <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">&lt;</span> m
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> _result
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br></div></div><p>终于做完了(ಥ_ಥ)
刷了两个月题了，刚感觉渐入佳境，遇到简单的题，呵~ 不过如此
还是遇到了教我做人的题呀~</p> <hr> <p>这题其实还是有做个的题目的影子:</p> <ul><li>有障碍的矩阵步数统计</li> <li>四个方向行进的矩阵路线</li></ul> <p>但是这道题复杂的地方就是行进的组合情况比较多：</p> <ol><li>S-O-M</li> <li>M-O-M</li> <li>M-T
M 和 O 的选不固定，任意切换是都会产生新的路径，所以在动态规划记录 M-O-M 的组合是就比较复杂</li></ol> <p>昨天又刚好赶上加班，所以花了两天时间才把逻辑弄清楚</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">15 days ago</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
	<script src="/oneday_oneleetcode/assets/js/app.a6cb5e08.js" defer></script><script src="/oneday_oneleetcode/assets/js/2.f1097bd3.js" defer></script><script src="/oneday_oneleetcode/assets/js/68.0f7fc874.js" defer></script>
</body>

</html>